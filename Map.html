<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accessible Pujo Map - অ্যাক্সেসযোগ্য পুজো ম্যাপ</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Language Selector -->
    <div class="language-selector">
        <button class="lang-btn active" data-lang="en">EN</button>
        <button class="lang-btn" data-lang="bn">বাংলা</button>
    </div>

    <!-- Accessibility Tools -->
    <div class="accessibility-tools">
        <button class="access-btn" onclick="adjustFontSize('increase')" aria-label="Increase font size">
            <i class="fas fa-plus"></i>
        </button>
        <button class="access-btn" onclick="adjustFontSize('decrease')" aria-label="Decrease font size">
            <i class="fas fa-minus"></i>
        </button>
        <button class="access-btn" onclick="toggleHighContrast()" aria-label="Toggle high contrast">
            <i class="fas fa-adjust"></i>
        </button>
        <button class="access-btn" onclick="speakText()" aria-label="Read aloud">
            <i class="fas fa-volume-up"></i>
        </button>
    </div>

    <!-- Header Section -->
    <header class="header-section">
        <div class="container">
            <h1 class="header-title" data-translate="title">Feel Safe, Celebrate Freely — We're With You This Pujo</h1>
            <p class="header-subtitle" data-translate="subtitle">Real-time guidance for safer, smarter pandal hopping.</p>
            <div class="action-buttons">
                <button class="action-btn" onclick="searchPandal()">
                    <i class="fas fa-search"></i>
                    <span data-translate="search">Search a Pandal</span>
                </button>
                <button class="action-btn" onclick="locateMe()">
                    <i class="fas fa-location-dot"></i>
                    <span data-translate="locate">Locate Me</span>
                </button>
                <button class="action-btn" onclick="showSOS()">
                    <i class="fas fa-phone"></i>
                    <span data-translate="sos">SOS / Help Center</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container my-4">
        <!-- Search Section -->
        <section class="search-section">
            <div class="row">
                <div class="col-md-8">
                    <input type="text" class="search-input" id="searchInput" placeholder="Search for a puja name or area..." data-translate-placeholder="search-placeholder">
                </div>
                <div class="col-md-4">
                    <button class="btn btn-primary w-100" onclick="performSearch()">
                        <i class="fas fa-search"></i> <span data-translate="search-btn">Search</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Route Planner -->
        <section class="route-planner">
            <h4 class="mb-3" data-translate="route-planner">Route Planner</h4>
            <div class="row">
                <div class="col-md-6">
                    <input type="text" class="route-input" id="fromLocation" placeholder="From: Your location" data-translate-placeholder="from-placeholder">
                </div>
                <div class="col-md-6">
                    <input type="text" class="route-input" id="toLocation" placeholder="To: Selected pandal" data-translate-placeholder="to-placeholder">
                </div>
            </div>
            <button class="btn btn-success w-100 mt-3" onclick="planRoute()">
                <i class="fas fa-route"></i> <span data-translate="plan-route">Plan Accessible Route</span>
            </button>
        </section>

        <!-- Crowd Heatmap Toggle -->
        <section class="heatmap-toggle">
            <button class="heatmap-btn low" onclick="toggleHeatmap('low')">
                <i class="fas fa-circle"></i> Low
            </button>
            <button class="heatmap-btn moderate" onclick="toggleHeatmap('moderate')">
                <i class="fas fa-circle"></i> Moderate
            </button>
            <button class="heatmap-btn heavy" onclick="toggleHeatmap('heavy')">
                <i class="fas fa-circle"></i> Heavy
            </button>
        </section>

        <!-- Map Container -->
        <section class="map-container">
            <div id="map"></div>
            <div class="loading-spinner" id="mapLoader" style="display: none;">
                <div class="spinner"></div>
            </div>
        </section>

        <!-- Filter Panel -->
        <section class="filter-panel">
            <h4 class="filter-title" data-translate="filters">Map Filters</h4>
            <div class="row">
                <div class="col-md-6">
                    <div class="filter-checkbox">
                        <input type="checkbox" id="accessiblePandals" checked>
                        <label for="accessiblePandals" data-translate="accessible-pandals">Show only Accessible Pandals</label>
                    </div>
                    <div class="filter-checkbox">
                        <input type="checkbox" id="lowCrowd">
                        <label for="lowCrowd" data-translate="low-crowd">Show Low Crowd Areas</label>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="filter-checkbox">
                        <input type="checkbox" id="volunteerDesks" checked>
                        <label for="volunteerDesks" data-translate="volunteer-desks">Show Volunteer Help Desks</label>
                    </div>
                    <div class="filter-checkbox">
                        <input type="checkbox" id="facilitiesNearMe">
                        <label for="facilitiesNearMe" data-translate="facilities-near-me">Show Facilities near Me</label>
                    </div>
                </div>
            </div>
            <button class="btn btn-primary mt-3" onclick="applyFilters()">Apply Filters</button>
        </section>

        <!-- Transportation Panel -->
        <section class="transport-panel">
            <h4 class="mb-3" data-translate="transportation">Transportation Options</h4>
            <div class="transport-tabs">
                <button class="transport-tab active" onclick="showTransport('metro')">
                    <i class="fas fa-subway"></i> Metro
                </button>
                <button class="transport-tab" onclick="showTransport('train')">
                    <i class="fas fa-train"></i> Train
                </button>
                <button class="transport-tab" onclick="showTransport('bus')">
                    <i class="fas fa-bus"></i> Bus
                </button>
            </div>
            
            <div id="metroTimetable" class="timetable">
                <h5 data-translate="metro-schedule">Metro Schedule</h5>
                <table>
                    <thead>
                        <tr>
                            <th data-translate="line">Line</th>
                            <th data-translate="station">Nearest Station</th>
                            <th data-translate="frequency">Frequency</th>
                            <th data-translate="last-train">Last Train</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Blue Line</td>
                            <td>Esplanade</td>
                            <td>5-7 min</td>
                            <td>10:30 PM</td>
                        </tr>
                        <tr>
                            <td>Blue Line</td>
                            <td>Mahatma Gandhi Road</td>
                            <td>5-7 min</td>
                            <td>10:30 PM</td>
                        </tr>
                        <tr>
                            <td>Green Line</td>
                            <td>Garia Bazar</td>
                            <td>10-15 min</td>
                            <td>9:45 PM</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div id="trainTimetable" class="timetable" style="display: none;">
                <h5 data-translate="train-schedule">Train Schedule</h5>
                <table>
                    <thead>
                        <tr>
                            <th data-translate="train">Train</th>
                            <th data-translate="from">From</th>
                            <th data-translate="to">To</th>
                            <th data-translate="departure">Departure</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>12864</td>
                            <td>Howrah</td>
                            <td>Digha</td>
                            <td>06:45 AM</td>
                        </tr>
                        <tr>
                            <td>12860</td>
                            <td>Sealdah</td>
                            <td>Diamond Harbour</td>
                            <td>07:20 AM</td>
                        </tr>
                        <tr>
                            <td>13124</td>
                            <td>Sealdah</td>
                            <td>Lalgola</td>
                            <td>08:15 AM</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div id="busTimetable" class="timetable" style="display: none;">
                <h5 data-translate="bus-schedule">Bus Routes</h5>
                <table>
                    <thead>
                        <tr>
                            <th data-translate="route">Route</th>
                            <th data-translate="stops">Major Stops</th>
                            <th data-translate="fare">Fare</th>
                            <th data-translate="service">Service</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>AC12</td>
                            <td>Esplanade - Garia</td>
                            <td>₹25</td>
                            <td>AC Bus</td>
                        </tr>
                        <tr>
                            <td>79B</td>
                            <td>Howrah - New Town</td>
                            <td>₹15</td>
                            <td>Non-AC</td>
                        </tr>
                        <tr>
                            <td>S6C</td>
                            <td>Esplanade - Airport</td>
                            <td>₹30</td>
                            <td>AC Bus</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Facility Highlights -->
        <section class="row">
            <div class="col-md-8">
                <h3 class="mb-3" data-translate="nearby-facilities">Nearby Facilities</h3>
                <div id="facilityCards">
                    <!-- Facility cards will be dynamically inserted here -->
                </div>
            </div>
            
            <div class="col-md-4">
                <!-- Safety Sidebar -->
                <div class="safety-sidebar">
                    <h4 class="mb-3" data-translate="emergency">Emergency Numbers</h4>
                    <a href="tel:100" class="emergency-number">
                        <i class="fas fa-phone"></i> Police - 100
                    </a>
                    <a href="tel:102" class="emergency-number">
                        <i class="fas fa-ambulance"></i> Ambulance - 102
                    </a>
                    <a href="tel:108" class="emergency-number">
                        <i class="fas fa-heartbeat"></i> Emergency - 108
                    </a>
                    <a href="tel:1091" class="emergency-number">
                        <i class="fas fa-female"></i> Women Helpline - 1091
                    </a>
                    
                    <hr class="my-3">
                    
                    <h5 class="mb-2" data-translate="quick-links">Quick Links</h5>
                    <a href="#" class="btn btn-sm btn-outline-primary mb-2 w-100" onclick="showLostFound()">
                        <i class="fas fa-search"></i> <span data-translate="lost-found">Lost & Found</span>
                    </a>
                    <a href="#" class="btn btn-sm btn-outline-success mb-2 w-100" onclick="volunteerSignup()">
                        <i class="fas fa-hands-helping"></i> <span data-translate="volunteer">Volunteer Signup</span>
                    </a>
                    <a href="#" class="btn btn-sm btn-outline-warning w-100" onclick="reportIssue()">
                        <i class="fas fa-exclamation-triangle"></i> <span data-translate="report">Report an Issue</span>
                    </a>
                </div>
                
                <!-- Saved Routes -->
                <div class="saved-routes">
                    <h5 class="mb-3" data-translate="saved-routes">Saved Routes</h5>
                    <div id="savedRoutesList">
                        <div class="saved-route-item" onclick="loadSavedRoute(1)">
                            <strong>South Kolkata Tour</strong>
                            <br><small>3 Pandals • 2 hours</small>
                        </div>
                        <div class="saved-route-item" onclick="loadSavedRoute(2)">
                            <strong>North Kolkata Heritage</strong>
                            <br><small>4 Pandals • 3 hours</small>
                        </div>
                    </div>
                    <button class="btn btn-sm btn-secondary w-100 mt-2" onclick="saveCurrentRoute()">
                        <i class="fas fa-bookmark"></i> <span data-translate="save-route">Save Current Route</span>
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Custom JS -->
    <script src="script.js"></script>
</body>
</html>